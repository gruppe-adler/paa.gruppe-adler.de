(()=>{"use strict";class t{constructor(t){this.memory=new WebAssembly.Memory({initial:256,maximum:32768}),this.ready=WebAssembly.instantiateStreaming(t,{env:{memory:this.memory,__sys_stat64:(t,e)=>-1,emscripten_notify_memory_growth:t=>this.updateViews()},wasi_snapshot_preview1:{fd_read:(t,e,i,n)=>-1,fd_close:t=>-1,fd_seek:(t,e,i,n,r)=>-1,fd_write:(t,e,i,n)=>-1,environ_sizes_get:(t,e)=>(this.dataView.setInt32(t,0,!0),this.dataView.setInt32(e,0,!0),0),environ_get:(t,e)=>0,proc_exit:t=>{}}}).then((({instance:t})=>{this.instance=t,this.updateViews()}))}get exports(){return this.instance.exports}updateViews(){this.dataView=new DataView(this.memory.buffer)}malloc(t){return this.exports.malloc(t)}free(t){this.exports.free(t)}writeBufferToMemory(t){const e=this.malloc(t.byteLength);if(0===e)throw new Error("Could not allocate memory for buffer");const i=new Uint8Array(t);for(let t=0;t<i.length;t++)this.dataView.setUint8(e+t,i[t]);return e}getBytesFromMemory(t,e){return new Uint8Array(this.memory.buffer).slice(t,t+e)}encode(t){const e=this.malloc(4),i=this.writeBufferToMemory(t.data.buffer),n=this.exports.encode(t.width,t.height,i,e),r=this.dataView.getUint32(e,!0),s=this.getBytesFromMemory(n,r);return this.free(e),this.free(i),s}decode(t){const e=this.malloc(4),i=this.malloc(2),n=this.malloc(2),r=this.writeBufferToMemory(t.buffer),s=this.exports.decode(r,t.length,i,n,e),o=this.dataView.getUint32(e,!0),a=this.dataView.getUint16(i,!0),c=this.dataView.getUint16(n,!0),f=this.getBytesFromMemory(s,o),h=new ImageData(new Uint8ClampedArray(f.buffer),a,c);return this.free(e),this.free(i),this.free(n),this.free(r),h}}var e=function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{c(n.next(t))}catch(t){s(t)}}function a(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}c((n=n.apply(t,e||[])).next())}))};function i(i){return e(this,void 0,void 0,(function*(){const e=(yield function(e="/grad_aff.wasm"){return i=this,n=void 0,s=function*(){("string"==typeof e||e instanceof Request||e instanceof URL)&&(e instanceof URL&&(e=e.toString()),e=fetch(e));const i=new t(e);return yield i.ready,i},new((r=void 0)||(r=Promise))((function(t,e){function o(t){try{c(s.next(t))}catch(t){e(t)}}function a(t){try{c(s.throw(t))}catch(t){e(t)}}function c(e){var i;e.done?t(e.value):(i=e.value,i instanceof r?i:new r((function(t){t(i)}))).then(o,a)}c((s=s.apply(i,n||[])).next())}));var i,n,r,s}()).encode(i);return new Blob([e.buffer],{type:"image/vnd.paa"})}))}addEventListener("message",(t=>e(void 0,void 0,void 0,(function*(){const e=t.data;let n;try{n={type:"data",data:yield i(e)}}catch(t){n={type:"error",data:t}}postMessage(n,this)}))))})();