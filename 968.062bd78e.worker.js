(()=>{"use strict";class e{constructor(e){this.memory=new WebAssembly.Memory({initial:256,maximum:32768}),this.ready=WebAssembly.instantiateStreaming(e,{env:{memory:this.memory,__sys_stat64:(e,t)=>-1,emscripten_notify_memory_growth:e=>this.updateViews()},wasi_snapshot_preview1:{fd_read:(e,t,n,i)=>-1,fd_close:e=>-1,fd_seek:(e,t,n,i,r)=>-1,fd_write:(e,t,n,i)=>-1,environ_sizes_get:(e,t)=>(this.dataView.setInt32(e,0,!0),this.dataView.setInt32(t,0,!0),0),environ_get:(e,t)=>0,proc_exit:e=>{}}}).then((({instance:e})=>{this.instance=e,this.updateViews()}))}get exports(){return this.instance.exports}updateViews(){this.dataView=new DataView(this.memory.buffer)}malloc(e){return this.exports.malloc(e)}free(e){this.exports.free(e)}writeBufferToMemory(e){const t=this.malloc(e.byteLength);if(0===t)throw new Error("Could not allocate memory for buffer");const n=new Uint8Array(e);for(let e=0;e<n.length;e++)this.dataView.setUint8(t+e,n[e]);return t}getBytesFromMemory(e,t){return new Uint8Array(this.memory.buffer).slice(e,e+t)}encode(e){const t=this.malloc(4),n=this.writeBufferToMemory(e.data.buffer),i=this.exports.encode(e.width,e.height,n,t),r=this.dataView.getUint32(t,!0),s=this.getBytesFromMemory(i,r);return this.free(t),this.free(n),s}decode(e){const t=this.malloc(4),n=this.malloc(2),i=this.malloc(2),r=this.writeBufferToMemory(e.buffer),s=this.exports.decode(r,e.length,n,i,t),o=this.dataView.getUint32(t,!0),a=this.dataView.getUint16(n,!0),c=this.dataView.getUint16(i,!0),f=this.getBytesFromMemory(s,o),h=new ImageData(new Uint8ClampedArray(f.buffer),a,c);return this.free(t),this.free(n),this.free(i),this.free(r),h}}var t=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};function n(n){return t(this,void 0,void 0,(function*(){const t=yield(i=n,new Promise(((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsArrayBuffer(i)})));var i;const r=new Uint8Array(t);return(yield function(t="/grad_aff.wasm"){return n=this,i=void 0,s=function*(){("string"==typeof t||t instanceof Request||t instanceof URL)&&(t instanceof URL&&(t=t.toString()),t=fetch(t));const n=new e(t);return yield n.ready,n},new((r=void 0)||(r=Promise))((function(e,t){function o(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,a)}c((s=s.apply(n,i||[])).next())}));var n,i,r,s}()).decode(r)}))}addEventListener("message",(e=>t(void 0,void 0,void 0,(function*(){const t=e.data;let i;try{i={type:"data",data:yield n(t)}}catch(e){i={type:"error",data:e}}postMessage(i,this)}))))})();